---
title: |
    | UNIVERSIDAD DE COSTA RICA
    | SISTEMA DE ESTUDIOS DE POSGRADO
    |
    |
    |
    |
subtitle: |
    | LA SOBREPARAMETRIZACIÓN EN EL ARIMA: UNA APLICACIÓN A DATOS COSTARRICENCES
    |
    |
    |
    |
    | Tesis sometida a la consideración de la Comisión del Programa de Estudios de Posgrado en Estadística para optar por el grado y título de Maestría Académica en Estadística
author: |
    |
    |
    |
    |
    |
    | CÉSAR ANDRÉS GAMBOA SANABRIA B12672
    |
    |
    |
    |
    |
    | Ciudad Universitaria Rodrigo Facio, Costa Rica
    |
    |
    |
date: "`r format(Sys.time(), '%Y')`"
always_allow_html: yes
output: 
    pdf_document:
        keep_tex: yes
        fig_caption: yes
        include:
          in_header: header.tex
urlcolor: blue
bibliography: referencias.bib
link-citations: yes
linkcolor: blue
csl: apa.csl
---

\pagenumbering{gobble}
\cleardoublepage

\newpage

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = TRUE, warning = FALSE, message = FALSE, dpi=1000,
                      dev="jpeg", out.width = '100%', out.height='100%', fig.pos="H",
                      echo=FALSE)

popstudy::required_packages(knitr, kableExtra, readxl, gridExtra, ggpubr, ggplot2, lubridate, 
                     ggseas, astsa, ggpmisc, forecast, 
                     tidyr, popstudy, DiagrammeR, Hmisc, dplyr)

oldSource <- knit_hooks$get("source")
knit_hooks$set(source = function(x, options) {
  x <- oldSource(x, options)
  x <- ifelse(!is.null(options$ref), paste0("\\label{", options$ref,"}", x), x)
  ifelse(!is.null(options$codecap), paste0("\\captionof{chunk}{", options$codecap,"}", x), x)
})
```

\addcontentsline{toc}{section}{DEDICATORIA}
\section*{DEDICATORIA}

\pagenumbering{roman}

A mi abuela, un pilar fundamental en mi vida sin cuyo apoyo no hubiese alcanzado muchas de mis metas y de quien aprendí que no desaparece lo que se muere, solo lo que se olvida. A mi madre, que junto con mi abuela me enseñaron en su más amplio sentido que quien no estudia, muere en el charco de la ignorancia.

A mi esposa, quien con su forma de ver la vida me sigue haciendo crecer tanto personal como académica y profesionalmente.

A mi tía, a mi hermana y su esposo, quienes con su comprensión en los momentos más difíciles supieron darme el aliento necesario y la motivación para seguir adelante.

A mis tíos, por velar en distintas etapas de mi vida que tuviera las heramientas necesarias para ser cada día una mejor persona.

\cleardoublepage


\addcontentsline{toc}{section}{AGRADECIMIENTOS}
\section*{AGRADECIMIENTOS}

Agradezco profundamente a Óscar Centeno Mora, quien con sus buenos consejos y dedicación ayudó a hacer posible este proyecto, a Gilbert Brenes Camacho y a Shu Wei Chou por sus valiosos aportes técnicos y sustantivos en el contexto de esta tesis, y a Cindy Cárdenas, por su invaluable apoyo administrativo en los momentos justos.

\cleardoublepage

\begin{center}

``Esta tesis fue aceptada por la Comisión del Programa de Estudios de Posgrado en Estadística de la Universidad de Costa Rica, como requisito parcial para optar al grado y título de Maestría Académica en Estadística''

\text{}

\noindent\rule{7cm}{0.4pt}\\
Ph.D. Flor Isabel Jiménez Segura\\
\textbf{Decano Sistema de Estudios de Posgrado}

\text{}

\noindent\rule{7cm}{0.4pt}\\
M.Sc. Óscar Centeno Mora\\
\textbf{Director de Tesis}

\text{}

\noindent\rule{7cm}{0.4pt}\\
Ph.D. Gilbert Brenes Camacho\\
\textbf{Lector}

\text{}

\noindent\rule{7cm}{0.4pt}\\
Ph.D. ShuWei Chou.\\
\textbf{Lector}

\text{}

\noindent\rule{7cm}{0.4pt}\\
Ph.D. Gilbert Brenes Camacho\\
\textbf{Director Programa de Posgrado en Estadística}

\text{}

\noindent\rule{7cm}{0.4pt}\\
César Andrés Gamboa Sanabria\\
\textbf{Candidato}

\end{center}

\cleardoublepage


\tableofcontents

\cleardoublepage

\addcontentsline{toc}{section}{RESUMEN}
\section*{RESUMEN}

Estimar modelos de series cronológicas es una labor ampliamente extendida en múltiples campos de la investigación y su objetivo último es generar pronósticos de la forma más precisa posible dentro de un horizonte determinado. Existe una amplia gama de modelos que puede utilizarse con este fin, entre ellos están los modelos Autorregresivos Integrados de Medias Móviles ($ARIMA$), e incluso existen diversos métodos de estimación automática o semi-automática para esta rama de la estadística. 

A pesar de esto, encontrar un modelo que posea un buen ajuste a los datos no es fácil, pues se deben considerar tanto aspectos teóricos como prácticos, y de la temática de estudio para así obtener un modelo adecuado que genere pronósticos realistas y pertinentes para la toma de decisiones dentro de lo posible.

La investigación propone hacer uso de método denominado sobreparametrización en conjunto con el método de permutaciones del análisis combinatorio para someter a prueba una espectro más amplio de posibles modelos $ARIMA$. En la selección de modelos ARIMA los métodos más tradicionales como los correlogramas u otros, no suelen cubrir muchas alternativas para definir la cantidad de coeficientes a estimar en el modelo, lo cual representa un método de estimación que no es óptimo. El presente tesis propone una metodología para obtener pronósticos más precisos en comparación a los métodos tradicionales.

Los resultados se contrastan con datos simulados de series cronológicas y cuatro series reales para ajustar modelos $ARIMA$ con la función `auto.arima()`, la sobreparametrización y un modelo $ARIMA$ de orden bajo. Para cada una de estas series se realiza una partición del 80% para entrenar los modelos y el restante 20% para validación de los pronósticos. En cada una de estas series se realizó un análisis visual del comportamiento de los errores y posteriormente se evalúa la calidad de los resultados de cada modelo obtenido con las tres técnicas descritas mediante medidas de bondad de ajuste (AIC, AICc y BIC) y de precisión (RMSE, MAE y MAPE).

Al tener datos que vienen de un proceso con bajo número de parámetros, la sobreparametrización logra captar de buena manera el comportamiento de la serie en comparación a las otras alternativas, y cuando el proceso que gobierna la serie es de un mayor grado, la metodología propuesta es capaz de capturar de mejor forma el comportamiento de la serie y conseguir pronósticos con una precisión mayor al de los métodos más tradicionales, pues en los resultados de entrenamiento, la sobreparametrización obtuvo el mejor ajuste un 58.33% de las veces y la mejor precisión el 45.45% de las veces, mientras que al evaluar los resultados sobre los conjuntos de datos de validación, la sobreparametrización obtuvo el mejor ajuste el 50% de las veces, mientras que las mejores medidas de precisión se alcanzaron un 67% del tiempo.

\cleardoublepage

\addcontentsline{toc}{section}{ABSTRACT}
\section*{ABSTRACT}

Time series analysis is widely extended in several research fields, and its goal is to generate forecasts as accurately as possible within a given horizon. Several models can be used for this purpose, among them are the Autoregressive Integrated Moving Average models (ARIMA). There are even some automatic or semi-automatic estimation methods for their calculation. 

Despite this, finding a well-fitted model is not easy, since both theoretical and practical aspects must be considered, as well as particular context to obtain an adequate model that generates realistic and relevant forecasts for decision making as much as possible. 

This research proposes the use of overparameterization combinatorial analysis to test a broader spectrum of possible $ARIMA$ models. In ARIMA model selection, the most traditional methods, such as correlograms, do not usually cover many alternatives to define the number of the coefficients to be estimated in the model, which represents a non-optimal estimation method. This thesis proposes a methodology to obtain more accurate forecasts compared to traditional methods. 

The results are contrasted with simulated time-series data and four real series to fit $ARIMA$ models with the `auto.arima()` function, overparameterization, and a low-order $ARIMA$ model. For each of these series, an 80% partition is made to train the models and the remaining 20% to validate the forecasts. 

In each of these series, a visual analysis of the behavior of the errors was carried out, and subsequently, the quality of the results of each model obtained with these three techniques was evaluated through measures of goodness of fit (AIC, AICc, and BIC) and precision (RMSE, MAE, and MAPE). 

By having data that comes from a process with a low number of parameters, the overparameterization manages to capture in a good way the behavior of the series compared to the other methods. When the process that rules the time series implies a higher degree, the proposed methodology leads to a well-capture-behavior of the series and achieving forecasts with greater precision than the more traditional methods.

In the training results, the overparameterization obtained the best fit 58.33% of the time and the best precision the 45.45% of the time. In comparison, when evaluating the results on the validation data sets, overparameterization obtained the best fit 50% of the time, while the best precision measures were achieved 67% of the time.

\cleardoublepage

\listoftables

\listoffigures

\cleardoublepage
\pagenumbering{arabic}

\newpage

\section{INTRODUCCIÓN}  

```{r, child="01-Introduccion.Rmd"}
```

\newpage

\section{MARCO TEÓRICO}

```{r, child="02-Marco_teorico.Rmd"}
```

\newpage

\section{METODOLOGÍA} 

```{r, child="03-Metodologia.Rmd"}
```


\newpage

\section{RESULTADOS} 

```{r, child="04-Resultados.Rmd"}
```

\newpage
\newpage

\section{CONCLUSIÓN Y DISCUSIONES}

```{r, child="05-Conclusiones.Rmd"}
```

\newpage

\section{ANEXOS}

```{r, child="06-Anexos.Rmd"}
```


\newpage

\section{REFERENCIAS}  

  